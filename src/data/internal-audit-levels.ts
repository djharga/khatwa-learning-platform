// ═══════════════════════════════════════════════════
// بيانات المستويات الثلاثة للمراجعة الداخلية
// ═══════════════════════════════════════════════════

export interface AuditLevelModule {
  title: string;
  description?: string;
  topics: string[];
  duration?: string;
  lessons?: number;
}

export interface AuditLevel {
  id: 1 | 2 | 3;
  title: string;
  description: string;
  modules: AuditLevelModule[];
}

export const auditLevels: AuditLevel[] = [
  {
    id: 1,
    title: 'المستوى الأول - التأسيس (Foundation)',
    description: 'أساسيات المراجعة الداخلية والمفاهيم الأولية',
    modules: [
      {
        title: 'المحور الأول: أساسيات المراجعة الداخلية',
        description: 'مقدمة شاملة لفهم المراجعة الداخلية ومبادئها',
        topics: [
          'تعريف وأهداف المراجعة الداخلية',
          'المفهوم والدور الاستراتيجي للمراجعة الداخلية',
          'المعايير والكفاءات المطلوبة',
          'منهجية التدقيق',
          'أخلاقيات المهنة',
          'أدلة إدارة المراجعة الداخلية',
          'ميثاق المراجعة الداخلية',
          'هيكل الإدارة - الصلاحيات - المسؤوليات'
        ],
      },
      {
        title: 'الإطار التنظيمي والأنظمة',
        topics: [
          'الأنظمة واللوائح المنظمة للمراجعة الداخلية',
          'الإطار التنظيمي للمراجعة',
          'القوانين واللوائح المتعلقة',
          'الهيئات التنظيمية'
        ],
      },
      {
        title: 'المحور الثاني: إدارة المخاطر',
        description: 'فهم وتقييم وإدارة المخاطر',
        topics: [
          'تحديد المخاطر',
          'طرق تحديد وتصنيف المخاطر',
          'تقييم المخاطر',
          'مفهوم المراجعة المبنية على المخاطر',
          'مصفوفة المخاطر (Risk Matrix)',
          'إعداد خطة المراجعة السنوية',
          'خطوات إعداد الخطة خطوة بخطوة',
          'مراجعة الخطة وتحديثها'
        ],
      },
      {
        title: 'إعداد برنامج المراجعة',
        topics: [
          'خطوات إعداد البرنامج',
          'النطاق والعمل التنفيذي',
          'أوراق العمل (Workpapers)',
          'التوثيق والاعتماد'
        ],
      },
      {
        title: 'تنفيذ إجراءات المراجعة',
        topics: [
          'جمع الأدلة والمستندات',
          'أساليب وأدوات المراجعة',
          'توثيق النتائج',
          'التحقق من الضوابط الداخلية'
        ],
      },
      {
        title: 'تحليل النتائج وتقييم المخاطر',
        topics: [
          'التمييز بين الملاحظة، النتيجة، والاستنتاج',
          'تقييم فعالية الرقابة الداخلية',
          'ربط النتائج بالأهداف الاستراتيجية'
        ],
      },
      {
        title: 'إعداد التقارير',
        topics: [
          'مكونات تقرير المراجعة',
          'الصياغة الموضوعية والحيادية',
          'التقارير التفصيلية مقابل المختصرة'
        ],
      },
      {
        title: 'متابعة تنفيذ التوصيات',
        topics: [
          'آلية خطة العمل لتنفيذ التوصيات',
          'تحديد المسؤوليات والجدول الزمني',
          'رفع تقارير المتابعة الدورية'
        ],
      },
      {
        title: 'التحضير لمقابلات العمل للمراجعين الداخليين',
        topics: [
          'المهارات المطلوبة في مقابلات المراجعة الداخلية',
          'إعداد السيرة الذاتية المهنية',
          'الأسئلة الشائعة في مقابلات المراجعين',
          'نماذج المقابلات العملية',
          'نصائح للنجاح في مقابلات المراجعة الداخلية'
        ],
      }
    ]
  },
  {
    id: 2,
    title: 'المستوى الثاني - الريادة (Leadership)',
    description: 'التطبيق العملي والأدوات المتقدمة',
    modules: [
      {
        title: 'إطار COSO العالمي',
        topics: [
          'تصميم وتقييم أنظمة الرقابة الداخلية',
          'حماية الأصول',
          'دقة التقارير المالية',
          'ضمان الالتزام بالقوانين'
        ],
      },
      {
        title: 'التقييم المستمر وتحسين الأداء',
        topics: [
          'مراقبة الجودة (أدوات التقييم الذاتي - مراجعة خارجية)',
          'تحديد الفجوات في الأداء',
          'خطط تطوير الكفاءات المهنية'
        ],
      },
      {
        title: 'أدوات المراجعة المتقدمة',
        topics: [
          'استخدام التقنيات والأدوات الحديثة في المراجعة',
          'تحليل البيانات في المراجعة',
          'كيفية استخدام تحليل البيانات',
          'أدوات تحليل البيانات',
          'مراجعة نظم وأمن المعلومات (IT Audit)',
          'تقييم ضوابط الوصول للأنظمة',
          'مراجعة التطبيقات والبرامج',
          'تحليل البيانات باستخدام (ACL, IDEA, Power BI)',
          'الحوكمة الرقمية والامتثال التقني'
        ],
      },
      {
        title: 'منهجية COBIT لحوكمة تكنولوجيا المعلومات',
        topics: [
          'ربط الأهداف التقنية بالأهداف التشغيلية',
          'علاقة COBIT و COSO في الرقابة الداخلية'
        ],
      },
      {
        title: 'الاحتيال (Fraud Management)',
        topics: [
          'أنواع الاحتيال (المالي، التشغيلي، الإلكتروني)',
          'تحليل مخاطر الاحتيال',
          'تقييم ضوابط الوقاية والكشف',
          'سياسات مكافحة الاحتيال',
          'آليات الإبلاغ والحماية',
          'إعداد تقارير التحقيقات الداخلية'
        ],
      },
      {
        title: 'الحوكمة المخاطر الامتثال (GRC)',
        topics: [
          'تصميم وتنفيذ برامج الحوكمة المتكاملة',
          'دمج الحوكمة مع إدارة الرقابة والمخاطر',
          'الحوكمة الرقمية والالتزام بالقوانين واللوائح'
        ],
      },
      {
        title: 'حالات عملية متقدمة',
        topics: [
          'أمثلة واقعية من الصناعات المختلفة',
          'تدريب جماعي وتحليل مواقف',
          'محاكاة جلسات مراجعة حقيقية'
        ],
      },
      {
        title: 'الدليل العملي للنماذج التشغيلية',
        topics: [
          'أدلة وسياسات وإجراءات شاملة',
          'نماذج إدارات ومصفوفة صلاحيات',
          'خطط مراجعة سنوية وربعية',
          'مؤشرات الأداء الرئيسية (KPIS)',
          'نماذج التقييم والمتابعة'
        ],
      }
    ]
  },
  {
    id: 3,
    title: 'المستوى الثالث - تطوير الكفاءات المتكاملة',
    description: 'المعايير الدولية والقيادة الإستراتيجية',
    modules: [
      {
        title: 'المهارات المالية لغير الماليين',
        topics: [
          'فهم القوائم المالية الأساسية (الدخل، الميزانية، التدفقات)',
          'مؤشرات الأداء المالي والتشغيلي',
          'التحليل المبسط وربط النتائج بالمخاطر التشغيلية',
          'النسب المالية الأساسية وتفسيرها'
        ],
      },
      {
        title: 'المعايير الدولية للمراجعة الداخلية',
        topics: [
          'معايير IIA',
          'المعايير الدولية للمراجعين الداخليين',
          'تطبيق المعايير الدولية',
          'كيفية تطبيق المعايير في الواقع',
          'المصطلحات المالية والإدارية والمحاسبية الأساسية',
          'إعداد عروض PowerPoint احترافية للمراجعة',
          'استخدام Excel المتقدم لتحليل البيانات',
          'استخدام Power BI للإعداد التقارير التفاعلية',
          'اللغة الإنجليزية في سياق المراجعة الداخلية'
        ],
      },
      {
        title: 'مهارات الإقناع والتفاوض وكتابة التقارير',
        topics: [
          'فن إقناع الإدارة بجدوى التوصيات',
          'استخدام البيانات والأدلة لصياغة الآراء المهنية',
          'التواصل الفعال مع الأنماط المختلفة من الشخصيات',
          'التفاوض البناء وإدارة الاعتراضات باحترافية',
          'التأثير في عملية اتخاذ القرارات',
          'دعم سياسات الشركة وتوصيل رسائل الإدارة',
          'كتابة التقارير المؤثرة والواضحة',
          'تقنيات العرض والتقديم المؤثر'
        ],
      }
    ]
  }
];

/**
 * تحويل بيانات المستويات إلى هيكل Modules و Lessons
 * للاستخدام في صفحة الدروس
 */
export interface File {
  id: number;
  title: string;
  type: 'video' | 'pdf' | 'audio';
  size: string;
  duration?: string;
  url?: string;
  videoUrl?: string;
}

export interface Lesson {
  id: number;
  title: string;
  order: number;
  files: File[];
  description?: string;
  objectives?: string[];
  videoUrl?: string;
}

export interface Module {
  id: number;
  title: string;
  order: number;
  lessons: Lesson[];
  isLevel?: boolean; // للتمييز بين المستوى والمحور
  levelId?: number; // معرف المستوى التابع له
}

/**
 * تحويل بيانات المستويات إلى هيكل Modules و Lessons
 * الهيكل: المستوى (Module رئيسي) -> المحور (Module فرعي) -> المحور الفرعي (Lessons)
 */
export function convertAuditLevelsToModules(): Module[] {
  const modules: Module[] = [];
  let globalModuleId = 1;
  let globalLessonId = 1;

  auditLevels.forEach((level) => {
    // إضافة المستوى كـ Module رئيسي (بدون lessons مباشرة)
    const levelModule: Module = {
      id: globalModuleId++,
      title: level.title,
      order: level.id,
      lessons: [], // المستوى لا يحتوي على lessons مباشرة
      isLevel: true,
      levelId: level.id,
    };
    modules.push(levelModule);

    // إضافة المحاور كـ Modules فرعية داخل المستوى
    level.modules.forEach((module, moduleIndex) => {
      // تحويل topics إلى Lessons (المحاور الفرعية)
      const moduleLessons: Lesson[] = module.topics.map((topic, topicIndex) => ({
        id: globalLessonId++,
        title: topic,
        order: topicIndex + 1,
        files: [],
        description: module.description,
      }));

      // إضافة المحور كـ Module فرعي
      const moduleData: Module = {
        id: globalModuleId++,
        title: module.title,
        order: moduleIndex + 1,
        lessons: moduleLessons, // المحور يحتوي على Lessons (المحاور الفرعية)
        isLevel: false,
        levelId: level.id,
      };

      modules.push(moduleData);
    });
  });

  return modules;
}

/**
 * الحصول على بيانات المستوى حسب المعرف
 */
export function getLevelById(levelId: 1 | 2 | 3): AuditLevel | undefined {
  return auditLevels.find(level => level.id === levelId);
}

/**
 * الحصول على جميع المحاور لمستوى معين
 */
export function getModulesByLevelId(levelId: 1 | 2 | 3): AuditLevelModule[] {
  const level = getLevelById(levelId);
  return level?.modules || [];
}

